import{_ as h,a as m}from"./Searchbar.5b967837.js";import{_ as f,d as P,u as _,r as u,c as v,n as b,q as g,s as w,x as y,e as S,i as d,o as B}from"./index.29837664.js";import"./time.747ead48.js";const L=P({name:"Home",components:{Searchbar:h,Posts:m},setup(a){const t=_(),s=u([]),c=u(null),e=v(()=>t.getters["post/publicPosts"]),i=async o=>{s.value.length=0,await t.dispatch("post/fetchPublicPosts",{sortby:o,page:1}),s.value.push(...e.value.posts)},r=async o=>{s.value.length=0,await t.dispatch("post/initPublicData"),await t.dispatch("post/fetchPublicPosts",{keyword:o}),s.value.push(...e.value.posts)},p=async()=>{const{page:o,hasNextPage:n}=e.value;n&&(await t.dispatch("post/fetchPublicPosts",{page:o+1}),s.value.push(...e.value.posts))},l=o=>{c.value.getBoundingClientRect().bottom<window.innerHeight&&p()};return b(async()=>{await t.dispatch("post/fetchPublicPosts"),s.value.push(...e.value.posts),window.addEventListener("scroll",l)}),g(()=>{window.removeEventListener("scroll",l)}),w((o,n)=>{t.dispatch("post/initPublicData"),t.dispatch("post/fetchPublicPosts")}),y((o,n)=>{s.value.length=0,t.dispatch("post/initPublicData")}),{storePost:e,sort:i,search:r,postsList:s,scrollComponent:c}}}),C={ref:"scrollComponent"};function H(a,t,s,c,e,i){const r=h,p=m;return B(),S("div",C,[d(r,{sort:a.storePost.sortby,onSort:a.sort,onSearch:a.search},null,8,["sort","onSort","onSearch"]),d(p,{posts:a.postsList},null,8,["posts"])],512)}var E=f(L,[["render",H]]);export{E as default};
